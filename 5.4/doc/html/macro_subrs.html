<HTML>
<HEAD>
<TITLE> Macro/Shell Extensions </TITLE>
</HEAD>
<BODY>
<A NAME="Macro_Subroutines"></A>
<H2> Macro Subroutines </H2>
<P>
<H3>Built in Variables</H3>
</P><P>
These variables are read-only and can not be changed.
</P><P>
<PRE>
<B>$active_pane</B>
</PRE>
Index of the current pane.
</P><P>
<PRE>
<B>$auto_indent</B>
</PRE>
Contains the current preference for auto indent. 
Can be  "off", "on" or "auto".
</P><P>
<PRE>
<B>$calltip_ID</B>
</PRE>
Equals the ID of the currently displayed calltip, or 0 if no calltip is
being displayed.
</P><P>
<PRE>
<B>$cursor</B>
</PRE>
Position of the cursor in the current window.
</P><P>
<PRE>
<B>$column</B>
</PRE>
Column number of the cursor position in the current window.
</P><P>
<PRE>
<B>$display_width</B>
</PRE>
Width of the current pane in pixels.
</P><P>
<PRE>
<B>$em_tab_dist</B>
</PRE>
If tab emulation is turned on in the Tabs...
dialog of the Preferences menu, value is the
distance between emulated tab stops. If tab
emulation is turned off, value is -1.
</P><P>
<PRE>
<B>$empty_array</B>
</PRE>
An array with no elements. This can be used to initialize 
an array to an empty state.
</P><P>
<PRE>
<B>$file_format</B>
</PRE>
Current newline format that the file will be saved with. Can 
be "unix", "dos" or "macintosh".
</P><P>
<PRE>
<B>$file_name</B>
</PRE>
Name of the file being edited in the current
window, stripped of directory component.
</P><P>
<PRE>
<B>$file_path</B>
</PRE>
Directory component of file being edited in the current window.
</P><P>
<PRE>
<B>$font_name</B>
</PRE>
Contains the current plain text font name.
</P><P>
<PRE>
<B>$font_name_bold</B>
</PRE>
Contains the current bold text font name.
</P><P>
<PRE>
<B>$font_name_bold_italic</B>
</PRE>
Contains the current bold-italic text font name.
</P><P>
<PRE>
<B>$font_name_italic</B>
</PRE>
Contains the current italic text font name.
</P><P>
<PRE>
<B>$highlight_syntax</B>
</PRE>
Whether syntax highlighting is turned on.
</P><P>
<PRE>
<B>$incremental_backup</B>
</PRE>
Contains 1 if incremental auto saving is on, otherwise 0.
</P><P>
<PRE>
<B>$incremental_search_line</B>
</PRE>
Has a value of 1 if the preference is 
selected to always show the incremental search line, otherwise 0.
</P><P>
<PRE>
<B>$language_mode</B>
</PRE>
Name of language mode set in the current window.
</P><P>
<PRE>
<B>$line</B>
</PRE>
Line number of the cursor position in the current window.
</P><P>
<PRE>
<B>$locked</B>
</PRE>
True if the file has been locked by the user.
</P><P>
<PRE>
<B>$make_backup_copy</B>
</PRE>
Has a value of 1 if original file is kept in a 
backup file on save, otherwise 0.
</P><P>
<PRE>
<B>$max_font_width</B>
</PRE>
The maximum font width of all the active styles. 
Syntax highlighting styles are only considered if syntax highlighting 
is turned on.
</P><P>
<PRE>
<B>$min_font_width</B>
</PRE>
The minimum font width of all the active styles. 
Syntax highlighting styles are only considered if syntax highlighting 
is turned on.
</P><P>
<PRE>
<B>$modified</B>
</PRE>
True if the file in the current window has
been modified and the modifications have not
yet been saved.
</P><P>
<PRE>
<B>$n_display_lines</B>
</PRE>
The number of lines visible in the currently active pane.
</P><P>
<PRE>
<B>$n_panes</B>
</PRE>
The number of panes in the current window.
</P><P>
<PRE>
<B>$overtype_mode</B>
</PRE>
True if in Overtype mode.
</P><P>
<PRE>
<B>$read_only</B>
</PRE>
True if the file is read only.
</P><P>
<PRE>
<B>$selection_start, $selection_end</B>   
</PRE>
Beginning and ending positions of the
primary selection in the current window, or
-1 if there is no text selected in the current window.
</P><P>
<PRE>
<B>$selection_left, $selection_right</B>  
</PRE>
Left and right character offsets of the rectangular (primary) selection in
the current window, or -1 if there is no selection or it is not rectangular.
</P><P>
<PRE>
<B>$server_name</B>
</PRE>
Name of the current NEdit server.
</P><P>
<PRE>
<B>$show_line_numbers</B>
</PRE>
Whether line numbers are shown next to the text.
</P><P>
<PRE>
<B>$show_matching</B>
</PRE>
Contains the current preference for showing matching pairs, 
such as "[]" and "{}" pairs. Can be "off", "delimiter", or "range".
</P><P>
<PRE>
<B>$match_syntax_based</B>
</PRE>
Whether pair matching should use syntax information, if available.
</P><P>
<PRE>
<B>$statistics_line</B>
</PRE>
Has a value of 1 if the statistics line is shown, otherwise 0.
</P><P>
<PRE>
<B>$sub_sep</B>
</PRE>
Contains the value of the array sub-script separation string.
</P><P>
<PRE>
<B>$tab_dist</B>
</PRE>
The distance between tab stops for a
hardware tab character, as set in the
Tabs... dialog of the Preferences menu.
</P><P>
<PRE>
<B>$text_length</B>
</PRE>
The length of the text in the current window.
</P><P>
<PRE>
<B>$top_line</B>
</PRE>
The line number of the top line of the currently active pane.
</P><P>
<PRE>
<B>$use_tabs</B>
</PRE>
Whether the user is allowing the NEdit to insert tab characters to maintain
spacing in tab emulation and rectangular dragging operations. (The setting of
the "Use tab characters in padding and emulated tabs" button in the Tabs...
dialog of the Preferences menu.)
</P><P>
<PRE>
<B>$wrap_margin</B>
</PRE>
The right margin in the current window for text wrapping and filling.
</P><P>
<PRE>
<B>$wrap_text</B>
</PRE>
The current wrap text mode. Values are "none", "auto" or "continuous".
</P><P>
<H3>Built-in Subroutines</H3>
</P><P>
<PRE>
<B>append_file( string, filename )</B>
</PRE>
Appends a string to a named file. Returns 1 on successful write, or 0 if
unsuccessful.
</P><P>
<PRE>
<B>beep()</B>
</PRE>
Ring the bell.
</P><P>
<PRE>
<B>calltip( "text_or_key" [, pos [, mode or position_modifier, ...]] )</B>
</PRE>
Pops up a calltip. &#60;pos&#62; is an optional position in the buffer where the tip
will be displayed.  Passing -1 for &#60;pos&#62; is equivalent to not specifying a 
position, and it guarantees that the tip will appear on-screen somewhere even
if the cursor is not.  The upper-left corner of the calltip will appear below
where the cursor would appear if it were at this position.  &#60;mode&#62; is one of
"tipText" (default), "tipKey", or "tagKey". "tipText" displays the text as-is,
"tagKey" uses it as the key to look up a tag, then converts the tag to a
calltip, and "tipKey" uses it as the key to look up a calltip, then falls back
to "tagKey" behavior if that fails.  You'll usually use "tipKey" or "tipText".
Finally, you can modify the placement of the calltip relative to the cursor
position (or &#60;pos&#62;) with one or more of these optional position modifiers:
"center" aligns the center of the calltip with the position.  "right" aligns
the right edge of the calltip with the position.  ("center" and "right" may 
not both be used.)  "above" places the calltip above the position.  "strict"
does not allow the calltip to move from its position in order to avoid going 
off-screen or obscuring the cursor.  Returns the ID of the calltip if it was 
found and/or displayed correctly, 0 otherwise.
</P><P>
<PRE>
<B>clipboard_to_string()</B>  
</PRE>
Returns the contents of the clipboard as a macro string. Returns empty
string on error.
</P><P>
<PRE>
<B>dialog( message, btn_1_label, btn_2_label, ... )</B>  
</PRE>
Pop up a dialog for querying and presenting information to the user. First
argument is a string to show in the message area of the dialog. Up to eight
additional optional arguments represent labels for buttons to appear along
the bottom of the dialog. Returns the number of the button pressed (the
first button is number 1), or 0 if the user closed the dialog via the window
close box.
</P><P>
<PRE>
<B>focus_window( window_name )</B>  
</PRE>
Sets the window on which subsequent macro commands operate. window_name can
be either a fully qualified file name, or one of "last" for the last window
created, or "next" for the next window in the chain from the currently
focused window (the first window being the one returned from calling
focus_window("last"). Returns the name of the newly-focused window, or an
empty string if the requested window was not found.
</P><P>
<PRE>
<B>get_character( position )</B>  
</PRE>
Returns the single character at the position
indicated by the first argument to the routine from the current window.
</P><P>
<PRE>
<B>get_range( start, end )</B>  
</PRE>
Returns the text between a starting and ending position from the current
window.
</P><P>
<PRE>
<B>get_selection()</B>  
</PRE>
Returns a string containing the text currently selected by the primary
selection either from the current window (no keyword), or from anywhere on
the screen (keyword "any").
</P><P>
<PRE>
<B>getenv( name )</B>
</PRE>
Gets the value of an environment variable.
</P><P>
<PRE>
<B>kill_calltip( [calltip_ID] )</B>
</PRE>
Kills any calltip that is being displayed in the window in which the macro is
running.  If there is no displayed calltip this does nothing.  If a calltip
ID is supplied then the calltip is killed only if its ID is calltip_ID.
</P><P>
<PRE>
<B>length( string )</B>
</PRE>
Returns the length of a string
</P><P>
<PRE>
<B>list_dialog( message, text, btn_1_label, btn_2_label, ... )</B>  
</PRE>
Pop up a dialog for prompting the user to choose a line from the given text
string. The first argument is a message string to be used as a title for the
fixed text describing the list. The second string provides the list data:
this is a text string in which list entries are separated by newline
characters. Up to seven additional optional arguments represent labels for
buttons to appear along the bottom of the dialog. Returns the line of text
selected by the user as the function value (without any newline separator) or
the empty string if none was selected, and number of the button pressed (the
first button is number 1), in $list_dialog_button. If the user closes the
dialog via the window close box, the function returns the empty string, and
$list_dialog_button returns 0.
</P><P>
<PRE>
<B>max( n1, n2, ... )</B>
</PRE>
Returns the maximum value of all of its arguments
</P><P>
<PRE>
<B>min( n1, n2, ... )</B>
</PRE>
Returns the minimum value of all of its arguments
</P><P>
<PRE>
<B>read_file( filename )</B>  
</PRE>
Reads the contents of a text file into a string. On success, returns 1 in
$read_status, and the contents of the file as a string in the subroutine
return value. On failure, returns the empty string "" and an 0 $read_status.
</P><P>
<PRE>
<B>replace_in_string( string, search_for, replace_with [, type, "copy"] )</B>  
</PRE>
Replaces all occurrences of a search string in a string with a replacement
string. Arguments are 1: string to search in, 2: string to search for, 3:
replacement string.  There are two optional arguments.  One is a search type, 
either "literal", "case", "word", "caseWord", "regex", or "regexNoCase".  
The default search type is "literal".  If the optional "copy" argument is
specified, a copy of the input string is returned when no replacements were
performed.  By default an empty string ("") will be returned in this case.
Returns a new string with all of the replacements done.
</P><P>
<PRE>
<B>replace_range( start, end, string )</B>  
</PRE>
Replaces all of the text in the current window between two positions.
</P><P>
<PRE>
<B>replace_selection( string )</B>  
</PRE>
Replaces the primary-selection selected text in the current window.
</P><P>
<PRE>
<B>replace_substring( string, start, end, replace_with )</B>  
</PRE>
Replacing a substring between two positions in a string within another string.
</P><P>
<PRE>
<B>search( search_for, start [, search_type, wrap, direction] )</B>  
</PRE>
Searches silently in a window without dialogs, beeps, or changes to the
selection. Arguments are: 1: string to search for, 2: starting position.
Optional arguments may include the strings: "wrap" to make the search wrap
around the beginning or end of the string, "backward" or "forward" to change
the search direction ("forward" is the default), "literal", "case", "word",
"caseWord", "regex", or "regexNoCase" to change the search  type  (default is
"literal"). Returns the starting position of the  match, or -1 if nothing
matched. Also returns the ending position  of the match in $search_end.
</P><P>
<PRE>
<B>search_string( string, search_for, start [, search_type, direction] )</B> 
</PRE>
</P><P>
Built-in macro subroutine for searching a string. Arguments are 1: string to
search in, 2: string to search for, 3: starting position. Optional arguments
may include the strings: "wrap" to make the search wrap around the beginning
or end of the string, "backward" or "forward" to change the search direction
("forward" is the default), "literal", "case", "word", "caseWord", "regex",
or "regexNoCase" to change the search type (default is "literal"). Returns
the starting position of the match, or -1 if nothing matched. Also returns
the ending position of the match in $search_end.
</P><P>
<PRE>
<B>select( start, end )</B>  
</PRE>
Selects (with the primary selection) text in the current buffer between a
starting and ending position.
</P><P>
<PRE>
<B>select_rectangle( start, end, left, right )</B>  
</PRE>
Selects a rectangular area of text between a starting and ending position,
and confined horizontally to characters displayed between positions "left",
and "right".
</P><P>
<PRE>
<B>set_cursor_pos( position )</B>
</PRE>
Set the cursor position for the current window.
</P><P>
<PRE>
<B>shell_command( command, input_string )</B>  
</PRE>
Executes a shell command, feeding it input from input_string. On completion,
output from the command is returned as the function value, and the command's
exit status is returned in the global variable $shell_cmd_status.
</P><P>
<PRE>
<B>split(string, separation_string [, search_type])</B>
</PRE>
Splits a string using the separator specified. Optionally the search_type
argument can specify how the separation_string is interpreted. The default 
is "literal". The returned value is an array with keys beginning at 0.
</P><P>
<PRE>
<B>string_dialog( message, btn_1_label, btn_2_label, ... )</B>  
</PRE>
Pops up a dialog prompting the user to enter information. The first argument
is a string to show in the message area of the dialog. Up to nine additional
optional arguments represent labels for buttons to appear along the bottom of
the dialog. Returns the string entered by the user as the function value,
and number of the button pressed (the first button is number 1), in
$string_dialog_button. If the user closes the dialog via the window close
box, the function returns the empty string, and $string_dialog_button returns
0.
</P><P>
<PRE>
<B>string_compare(string1, string2 [, consider-case])</B>
</PRE>
Compare two  strings and return 0 if they are equal, -1 if string1 is less
than  string2 or 1 if string1 is greater than string2. The values for the
optional consider-case argument is either "case" or "nocase". The default 
is to do a case sensitive comparison.
</P><P>
<PRE>
<B>string_to_clipboard( string )</B>  
</PRE>
Copy the contents of a macro string to the clipboard.
</P><P>
<PRE>
<B>substring( string, start, end )</B>  
</PRE>
Returns the portion of a string between a starting and ending position.
</P><P>
<PRE>
<B>t_print( string1, string2, ... )</B>  
</PRE>
Writes strings to the terminal (stdout) from which NEdit was started.
</P><P>
<PRE>
<B>tolower( string )</B>
</PRE>
Return an all lower-case version of string.
</P><P>
<PRE>
<B>toupper( string )</B>
</PRE>
Return an all upper-case version of string.
</P><P>
<PRE>
<B>valid_number( string )</B>
</PRE>
Returns 1 if the string can be converted to a number without error
following the same rules that the implicit conversion would. Otherwise 0.
</P><P>
<PRE>
<B>write_file( string, filename )</B>  
</PRE>
Writes a string (parameter 1) to a file named in parameter 2. Returns 1 on
successful write, or 0 if unsuccessful.
</P><P>
<H3>Deprecated Functions</H3>
</P><P>
Some functions are included only for supporting legacy macros. You should not
use any of these functions in any new macro you write. Among these are all
action routines with hyphens in their names; use underscores instead
('find-dialog' -&#62; 'find_dialog').
</P><P>
<PRE>
<B>match()</B>
</PRE>
<B>DEPRECATED</B> Use select_to_matching() instead.
</P><P>
<P><HR>
</P><P>
</P>
</BODY>
</HTML>
